In mathematics, specifically functional analysis, Mercer's theorem is a representation of a symmetric positive-definite function on a square as a sum of a convergent sequence of product functions.  This theorem, presented in (Mercer 1909), is one of the most notable results of the work of James Mercer (1883–1932). It is an important theoretical tool in the theory of integral equations; it is used in the Hilbert space theory of stochastic processes, for example the Karhunen–Loève theorem; and it is also used to characterize a symmetric positive semi-definite kernel. Introduction To explain Mercer's theorem, we first consider an important special case; see below for a more general formulation.A kernel, in this context, is a symmetric continuous function                    K        :        [        a        ,        b        ]        ×        [        a        ,        b        ]        →                  R                      {\displaystyle K:[a,b]\times [a,b]\rightarrow \mathbb {R} }  where symmetric means that                     K        (        x        ,        y        )        =        K        (        y        ,        x        )              {\displaystyle K(x,y)=K(y,x)}   for all                     x        ,        y        ∈        [        a        ,        b        ]              {\displaystyle x,y\in [a,b]}  .K is said to be non-negative definite (or positive semidefinite) if and only if                              ∑                      i            =            1                                n                                    ∑                      j            =            1                                n                          K        (                  x                      i                          ,                  x                      j                          )                  c                      i                                    c                      j                          ≥        0              {\displaystyle \sum _{i=1}^{n}\sum _{j=1}^{n}K(x_{i},x_{j})c_{i}c_{j}\geq 0}  for all finite sequences of points x1, ..., xn of [a, b] and all choices of real numbers c1, ..., cn (cf. positive-definite kernel).Associated to K is a linear operator (more specifically a Hilbert–Schmidt integral operator) on functions defined by the integral                    [                  T                      K                          φ        ]        (        x        )        =                  ∫                      a                                b                          K        (        x        ,        s        )        φ        (        s        )                d        s        .              {\displaystyle [T_{K}\varphi ](x)=\int _{a}^{b}K(x,s)\varphi (s)\,ds.}  For technical considerations we assume                     φ              {\displaystyle \varphi }   can range through the space L2[a, b] (see Lp space) of square-integrable real-valued functions.Since TK is a linear operator, we can talk about eigenvalues and eigenfunctions of TK.Theorem. Suppose K is a continuous symmetric non-negative definite kernel.  Then there is an orthonormal basis{ei}i of L2[a, b] consisting of eigenfunctions of TK such that the correspondingsequence of eigenvalues {λi}i is nonnegative.  The eigenfunctions corresponding to non-zero eigenvalues are continuous on [a, b] and K has the representation                    K        (        s        ,        t        )        =                  ∑                      j            =            1                                ∞                                    λ                      j                                            e                      j                          (        s        )                          e                      j                          (        t        )              {\displaystyle K(s,t)=\sum _{j=1}^{\infty }\lambda _{j}\,e_{j}(s)\,e_{j}(t)}  where the convergence is absolute and uniform. Details We now explain in greater detail the structure of the proof ofMercer's theorem, particularly how it relates to spectral theory of compact operators.The map K → TK is  injective.TK is a non-negative symmetric  compact operator on L2[a,b]; moreover K(x, x) ≥ 0.To show compactness, show that the image of the unit ball of L2[a,b] under TK equicontinuous and apply Ascoli's theorem, to show that the image of the unit ball is relatively compact in C([a,b]) with the uniform norm and a fortiori in L2[a,b].Now apply the spectral theorem for compact operators on Hilbertspaces to TK to show the existence of theorthonormal basis {ei}i ofL2[a,b]                              λ                      i                                    e                      i                          (        t        )        =        [                  T                      K                                    e                      i                          ]        (        t        )        =                  ∫                      a                                b                          K        (        t        ,        s        )                  e                      i                          (        s        )                d        s        .              {\displaystyle \lambda _{i}e_{i}(t)=[T_{K}e_{i}](t)=\int _{a}^{b}K(t,s)e_{i}(s)\,ds.}  If λi ≠ 0, the eigenvector (eigenfunction) ei is seen to be continuous on [a,b].  Now                              ∑                      i            =            1                                ∞                                    λ                      i                                    |                          e                      i                          (        t        )                  e                      i                          (        s        )                  |                ≤                  sup                      x            ∈            [            a            ,            b            ]                                    |                K        (        x        ,        x        )                  |                ,              {\displaystyle \sum _{i=1}^{\infty }\lambda _{i}|e_{i}(t)e_{i}(s)|\leq \sup _{x\in [a,b]}|K(x,x)|,}  which shows that the sequence                              ∑                      i            =            1                                ∞                                    λ                      i                                    e                      i                          (        t        )                  e                      i                          (        s        )              {\displaystyle \sum _{i=1}^{\infty }\lambda _{i}e_{i}(t)e_{i}(s)}  converges absolutely and uniformly to a kernel K0 which is easily seen to define the same operator as the kernel K.  Hence K=K0 from which Mercer's theorem follows.Finally, to show non-negativity of the eigenvalues one can write                     λ        ⟨        f        ,        f        ⟩        =        ⟨        f        ,                  T                      K                          f        ⟩              {\displaystyle \lambda \langle f,f\rangle =\langle f,T_{K}f\rangle }   and expressing the right hand side as an integral well approximated by its Riemann sums, which are non-negativeby positive-definiteness of K, implying                     λ        ⟨        f        ,        f        ⟩        ≥        0              {\displaystyle \lambda \langle f,f\rangle \geq 0}  , implying                     λ        ≥        0              {\displaystyle \lambda \geq 0}  . Trace The following is immediate:Theorem.  Suppose K is a continuous symmetric non-negative definite kernel; TK has a  sequence of nonnegativeeigenvalues {λi}i.  Then                              ∫                      a                                b                          K        (        t        ,        t        )                d        t        =                  ∑                      i                                    λ                      i                          .              {\displaystyle \int _{a}^{b}K(t,t)\,dt=\sum _{i}\lambda _{i}.}  This shows that the operator TK is a trace class operator and                    trace        ⁡        (                  T                      K                          )        =                  ∫                      a                                b                          K        (        t        ,        t        )                d        t        .              {\displaystyle \operatorname {trace} (T_{K})=\int _{a}^{b}K(t,t)\,dt.}   Generalizations Mercer's theorem itself is a generalization of the result that any symmetric positive-semidefinite matrix is the Gramian matrix of a set of vectors.The first generalization replaces the interval [a, b] with any compact Hausdorff space and Lebesgue measure on [a, b] is replaced by a finite countably additive measure μ on the Borel algebra of X whose support is X.  This means that μ(U) > 0 for any nonempty open subset U of X.A recent generalization replaces these conditions by the following: the set X is a first-countable topological space endowed with a Borel (complete) measure μ. X is the support of μ and, for all x in X, there is an open set U containing x and having finite measure. Then essentially the same result holds:Theorem. Suppose K is a continuous symmetric  positive-definite kernel on X. If the function κ is L1μ(X), where κ(x)=K(x,x), for all x in X, then there is an orthonormal set{ei}i of L2μ(X) consisting of eigenfunctions of TK such that correspondingsequence of eigenvalues {λi}i is nonnegative.  The eigenfunctions corresponding to non-zero eigenvalues are continuous on X and K has the representation                    K        (        s        ,        t        )        =                  ∑                      j            =            1                                ∞                                    λ                      j                                            e                      j                          (        s        )                          e                      j                          (        t        )              {\displaystyle K(s,t)=\sum _{j=1}^{\infty }\lambda _{j}\,e_{j}(s)\,e_{j}(t)}  where the convergence is absolute and uniform on compact subsets of X.The next generalization deals with representations of measurable kernels.Let (X, M, μ) be a σ-finite measure space.  An L2 (or square-integrable) kernel on X is a function                    K        ∈                  L                      μ            ⊗            μ                                2                          (        X        ×        X        )        .              {\displaystyle K\in L_{\mu \otimes \mu }^{2}(X\times X).}  L2 kernels define a bounded operator TK by the formula                    ⟨                  T                      K                          φ        ,        ψ        ⟩        =                  ∫                      X            ×            X                          K        (        y        ,        x        )        φ        (        y        )        ψ        (        x        )                d        [        μ        ⊗        μ        ]        (        y        ,        x        )        .              {\displaystyle \langle T_{K}\varphi ,\psi \rangle =\int _{X\times X}K(y,x)\varphi (y)\psi (x)\,d[\mu \otimes \mu ](y,x).}  TK is a compact operator (actually it is even a Hilbert–Schmidt operator).  If the kernel K is symmetric, by the spectral theorem, TK  has an orthonormal basis of eigenvectors. Those eigenvectors that correspond to non-zero eigenvalues can be arranged in a sequence {ei}i (regardless of separability).Theorem.  If K is a symmetric positive-definite kernel on (X, M, μ), then                    K        (        y        ,        x        )        =                  ∑                      i            ∈                          N                                                λ                      i                                    e                      i                          (        y        )                  e                      i                          (        x        )              {\displaystyle K(y,x)=\sum _{i\in \mathbb {N} }\lambda _{i}e_{i}(y)e_{i}(x)}  where the convergence in the  L2 norm.  Note that when continuity of the kernel is not assumed, the expansion no longer converges uniformly. Mercer's condition In mathematics, a real-valued function K(x,y) is said to fulfill Mercer's condition if for all square-integrable functions g(x) one has                    ∬        g        (        x        )        K        (        x        ,        y        )        g        (        y        )                d        x                d        y        ≥        0.              {\displaystyle \iint g(x)K(x,y)g(y)\,dx\,dy\geq 0.}  = Discrete analog =This is analogous to the definition of a positive-semidefinite matrix. This is a matrix                     K              {\displaystyle K}   of dimension                     N              {\displaystyle N}  , which satisfies, for all vectors                     g              {\displaystyle g}  , the property                    (        g        ,        K        g        )        =                  g                      T                                    ⋅                K        g        =                  ∑                      i            =            1                                N                                    ∑                      j            =            1                                N                                            g                      i                                            K                      i            j                                            g                      j                          ≥        0              {\displaystyle (g,Kg)=g^{T}{\cdot }Kg=\sum _{i=1}^{N}\sum _{j=1}^{N}\,g_{i}\,K_{ij}\,g_{j}\geq 0}  .= Examples =A positive constant function                    K        (        x        ,        y        )        =        c                      {\displaystyle K(x,y)=c\,}  satisfies Mercer's condition, as then the integral becomes by Fubini's theorem                     ∬        g        (        x        )                c                g        (        y        )                d        x        d        y        =        c        ∫                g        (        x        )                d        x        ∫                g        (        y        )                d        y        =        c                              (                          ∫                            g              (              x              )                            d              x                        )                                2                                {\displaystyle \iint g(x)\,c\,g(y)\,dxdy=c\int \!g(x)\,dx\int \!g(y)\,dy=c\left(\int \!g(x)\,dx\right)^{2}}  which is indeed non-negative.  See also Kernel trickRepresenter theoremSpectral theory Notes  References Adriaan Zaanen, Linear Analysis, North Holland Publishing Co., 1960,Ferreira, J. C., Menegatto, V. A., Eigenvalues of integral operators defined by smooth positive definite kernels, Integral equation and Operator Theory, 64 (2009), no. 1, 61–81. (Gives the generalization of Mercer's theorem for metric spaces. The result is easily adapted to first countable topological spaces)Konrad Jörgens, Linear integral operators, Pitman, Boston, 1982,Richard Courant and David Hilbert, Methods of Mathematical Physics, vol 1, Interscience 1953,Robert Ash, Information Theory, Dover Publications, 1990,Mercer, J. (1909), "Functions of positive and negative type and their connection with the theory of integral equations", Philosophical Transactions of the Royal Society A, 209 (441–458): 415–446, Bibcode:1909RSPTA.209..415M, doi:10.1098/rsta.1909.0016,"Mercer theorem", Encyclopedia of Mathematics, EMS Press, 2001 [1994]H. König, Eigenvalue distribution of compact operators, Birkhäuser Verlag, 1986. (Gives the generalization of Mercer's theorem for finite measures μ.)