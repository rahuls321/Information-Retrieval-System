
Title:
Wiener filter
Text:

		From Wikipedia, the free encyclopedia
		
		
		
		
		Jump to navigation
		Jump to search
		.mw-parser-output .hatnote{font-style:italic}.mw-parser-output div.hatnote{padding-left:1.6em;margin-bottom:0.5em}.mw-parser-output .hatnote i{font-style:normal}.mw-parser-output .hatnote+link+.hatnote{margin-top:-0.5em}Not to be confused with Wien filter or Wien bridge.
In signal processing, the Wiener filter is a filter used to produce an estimate of a desired or target random process by linear time-invariant (LTI) filtering of an observed noisy process, assuming known stationary signal and noise spectra, and additive noise. The Wiener filter minimizes the mean square error between the estimated random process and the desired process.

Contents

1 Description
2 Wiener filter solutions

2.1 Noncausal solution
2.2 Causal solution


3 Finite impulse response Wiener filter for discrete series

3.1 Relationship to the least squares filter
3.2 Complex signals


4 Applications
5 History
6 See also
7 References
8 External links



Description[edit]
The goal of the Wiener filter is to compute a statistical estimate of an unknown signal using a related signal as an input and filtering that known signal to produce the estimate as an output.  For example, the known signal might consist of an unknown signal of interest that has been corrupted by additive noise.  The Wiener filter can be used to filter out the noise from the corrupted signal to provide an estimate of the underlying signal of interest.  The Wiener filter is based on a statistical approach, and a more statistical account of the theory is given in the minimum mean square error (MMSE) estimator  article.
Typical deterministic filters are designed for a desired frequency response.  However, the design of the Wiener filter takes a different approach.  One is assumed to have knowledge of the spectral properties of the original signal and the noise, and one seeks the linear time-invariant filter whose output would come as close to the original signal as possible.  Wiener filters are characterized by the following:[1]

Assumption: signal and (additive) noise are stationary linear stochastic processes with known spectral characteristics or known autocorrelation and cross-correlation
Requirement: the filter must be physically realizable/causal (this requirement can be dropped, resulting in a non-causal solution)
Performance criterion: minimum mean-square error (MMSE)
This filter is frequently used in the process of deconvolution; for this application, see Wiener deconvolution.

Wiener filter solutions[edit]
Let 
  
    
      
        s
        (
        t
        )
      
    
    {\displaystyle s(t)}
  
 be an unknown signal which must be estimated from a measurement signal 
  
    
      
        x
        (
        t
        )
      
    
    {\displaystyle x(t)}
  
. The Wiener filter problem has solutions for three possible cases:  one where a noncausal filter is acceptable (requiring an infinite amount of both past and future data), the case where a causal filter is desired (using an infinite amount of past data), and the finite impulse response (FIR) case where only input data is used (i.e. the result or output is not fed back into the filter as in the IIR case). The first case is simple to solve but is not suited for real-time applications.  Wiener's main accomplishment was solving the case where the causality requirement is in effect; Norman Levinson gave the FIR solution in an appendix of Wiener's book.

Noncausal solution[edit]

  
    
      
        G
        (
        s
        )
        =
        
          
            
              
                S
                
                  x
                  ,
                  s
                
              
              (
              s
              )
            
            
              
                S
                
                  x
                
              
              (
              s
              )
            
          
        
        
          e
          
            Î±
            s
          
        
        ,
      
    
    {\displaystyle G(s)={\frac {S_{x,s}(s)}{S_{x}(s)}}e^{\alpha s},}
  

where  
  
    
      
        S
      
    
    {\displaystyle S}
  
 are spectral densities.  Provided that 
  
    
      
        g
        (
        t
        )
      
    
    {\displaystyle g(t)}
  
 is optimal, then the minimum mean-square error equation reduces to 


  
    
      
        E
        (
        
          e
          
            2
          
        
        )
        =
        
          R
          
            s
          
        
        (
        0
        )
        â
        
          â«
          
            â
            â
          
          
            â
          
        
        g
        (
        Ï
        )
        
          R
          
            x
            ,
            s
          
        
        (
        Ï
        +
        Î±
        )
        
        d
        Ï
        ,
      
    
    {\displaystyle E(e^{2})=R_{s}(0)-\int _{-\infty }^{\infty }g(\tau )R_{x,s}(\tau +\alpha )\,d\tau ,}
  

and the solution 
  
    
      
        g
        (
        t
        )
      
    
    {\displaystyle g(t)}
  
 is the inverse two-sided Laplace transform of 
  
    
      
        G
        (
        s
        )
      
    
    {\displaystyle G(s)}
  
.

Causal solution[edit]

  
    
      
        G
        (
        s
        )
        =
        
          
            
              H
              (
              s
              )
            
            
              
                S
                
                  x
                
                
                  +
                
              
              (
              s
              )
            
          
        
        ,
      
    
    {\displaystyle G(s)={\frac {H(s)}{S_{x}^{+}(s)}},}
  

where


  
    
      
        H
        (
        s
        )
      
    
    {\displaystyle H(s)}
  
 consists of the causal part of 
  
    
      
        
          
            
              
                S
                
                  x
                  ,
                  s
                
              
              (
              s
              )
            
            
              
                S
                
                  x
                
                
                  â
                
              
              (
              s
              )
            
          
        
        
          e
          
            Î±
            s
          
        
      
    
    {\displaystyle {\frac {S_{x,s}(s)}{S_{x}^{-}(s)}}e^{\alpha s}}
  
 (that is, that part of this fraction having a positive time solution under the inverse Laplace transform)

  
    
      
        
          S
          
            x
          
          
            +
          
        
        (
        s
        )
      
    
    {\displaystyle S_{x}^{+}(s)}
  
 is the causal component of 
  
    
      
        
          S
          
            x
          
        
        (
        s
        )
      
    
    {\displaystyle S_{x}(s)}
  
 (i.e., the inverse Laplace transform of 
  
    
      
        
          S
          
            x
          
          
            +
          
        
        (
        s
        )
      
    
    {\displaystyle S_{x}^{+}(s)}
  
 is non-zero only for 
  
    
      
        t
        â¥
        0
      
    
    {\displaystyle t\geq 0}
  
)

  
    
      
        
          S
          
            x
          
          
            â
          
        
        (
        s
        )
      
    
    {\displaystyle S_{x}^{-}(s)}
  
 is the anti-causal component of 
  
    
      
        
          S
          
            x
          
        
        (
        s
        )
      
    
    {\displaystyle S_{x}(s)}
  
 (i.e., the inverse Laplace transform of 
  
    
      
        
          S
          
            x
          
          
            â
          
        
        (
        s
        )
      
    
    {\displaystyle S_{x}^{-}(s)}
  
 is non-zero only for 
  
    
      
        t
        <
        0
      
    
    {\displaystyle t<0}
  
)
This general formula is complicated and deserves a more detailed explanation. To write down the solution 
  
    
      
        G
        (
        s
        )
      
    
    {\displaystyle G(s)}
  
 in a specific case, one should follow these steps:[2]

Start with the spectrum 
  
    
      
        
          S
          
            x
          
        
        (
        s
        )
      
    
    {\displaystyle S_{x}(s)}
  
 in rational form and factor it into causal and anti-causal components: 
  
    
      
        
          S
          
            x
          
        
        (
        s
        )
        =
        
          S
          
            x
          
          
            +
          
        
        (
        s
        )
        
          S
          
            x
          
          
            â
          
        
        (
        s
        )
      
    
    {\displaystyle S_{x}(s)=S_{x}^{+}(s)S_{x}^{-}(s)}
  
 where 
  
    
      
        
          S
          
            +
          
        
      
    
    {\displaystyle S^{+}}
  
 contains all the zeros and poles in the left half plane (LHP) and 
  
    
      
        
          S
          
            â
          
        
      
    
    {\displaystyle S^{-}}
  
 contains the zeroes and poles in the right half plane (RHP). This is called the WienerâHopf factorization.
Divide 
  
    
      
        
          S
          
            x
            ,
            s
          
        
        (
        s
        )
        
          e
          
            Î±
            s
          
        
      
    
    {\displaystyle S_{x,s}(s)e^{\alpha s}}
  
 by 
  
    
      
        
          S
          
            x
          
          
            â
          
        
        (
        s
        )
      
    
    {\displaystyle S_{x}^{-}(s)}
  
 and write out the result as a partial fraction expansion.
Select only those terms in this expansion having poles in the LHP.  Call these terms 
  
    
      
        H
        (
        s
        )
      
    
    {\displaystyle H(s)}
  
.
Divide 
  
    
      
        H
        (
        s
        )
      
    
    {\displaystyle H(s)}
  
 by 
  
    
      
        
          S
          
            x
          
          
            +
          
        
        (
        s
        )
      
    
    {\displaystyle S_{x}^{+}(s)}
  
.  The result is the desired filter transfer function 
  
    
      
        G
        (
        s
        )
      
    
    {\displaystyle G(s)}
  
.
Finite impulse response Wiener filter for discrete series[edit]
  Block diagram view of the FIR Wiener filter for discrete series. An input signal w[n] is convolved with the Wiener filter g[n] and the result is compared to a reference signal s[n] to obtain the filtering error e[n].
The causal finite impulse response (FIR) Wiener filter, instead of using some given data matrix X and output vector Y, finds optimal tap weights by using the statistics of the input and output signals. It populates the input matrix X with estimates of the auto-correlation of the input signal (T) and populates the output vector Y with estimates of the cross-correlation between the output and input signals (V).
In order to derive the coefficients of the Wiener filter, consider the signal w[n] being fed to a Wiener filter of order (number of past taps) N and with coefficients 
  
    
      
        {
        
          a
          
            0
          
        
        ,
        â¯
        ,
        
          a
          
            N
          
        
        }
      
    
    {\displaystyle \{a_{0},\cdots ,a_{N}\}}
  
. The output of the filter is denoted x[n] which is given by the expression


  
    
      
        x
        [
        n
        ]
        =
        
          â
          
            i
            =
            0
          
          
            N
          
        
        
          a
          
            i
          
        
        w
        [
        n
        â
        i
        ]
        .
      
    
    {\displaystyle x[n]=\sum _{i=0}^{N}a_{i}w[n-i].}
  

The residual error is denoted e[n] and is defined as e[n] = x[n]Â âÂ s[n] (see the corresponding block diagram). The Wiener filter is designed so as to minimize the mean square error (MMSE criteria) which can be stated concisely as follows:


  
    
      
        
          a
          
            i
          
        
        =
        arg
        â¡
        min
        E
        
          [
          
            
              e
              
                2
              
            
            [
            n
            ]
          
          ]
        
        ,
      
    
    {\displaystyle a_{i}=\arg \min E\left[e^{2}[n]\right],}
  

where 
  
    
      
        E
        [
        â
        ]
      
    
    {\displaystyle E[\cdot ]}
  
 denotes the expectation operator. In the general case, the coefficients 
  
    
      
        
          a
          
            i
          
        
      
    
    {\displaystyle a_{i}}
  
 may be complex and may be derived for the case where w[n] and s[n] are complex as well. With a complex signal, the matrix to be solved is a Hermitian Toeplitz matrix, rather than symmetric Toeplitz matrix.  For simplicity, the following considers only the case where all these quantities are real. The mean square error (MSE) may be rewritten as:


  
    
      
        
          
            
              
                E
                
                  [
                  
                    
                      e
                      
                        2
                      
                    
                    [
                    n
                    ]
                  
                  ]
                
              
              
                
                =
                E
                
                  [
                  
                    (
                    x
                    [
                    n
                    ]
                    â
                    s
                    [
                    n
                    ]
                    
                      )
                      
                        2
                      
                    
                  
                  ]
                
              
            
            
              
              
                
                =
                E
                
                  [
                  
                    
                      x
                      
                        2
                      
                    
                    [
                    n
                    ]
                  
                  ]
                
                +
                E
                
                  [
                  
                    
                      s
                      
                        2
                      
                    
                    [
                    n
                    ]
                  
                  ]
                
                â
                2
                E
                [
                x
                [
                n
                ]
                s
                [
                n
                ]
                ]
              
            
            
              
              
                
                =
                E
                
                  [
                  
                    
                      (
                      
                        
                          â
                          
                            i
                            =
                            0
                          
                          
                            N
                          
                        
                        
                          a
                          
                            i
                          
                        
                        w
                        [
                        n
                        â
                        i
                        ]
                      
                      )
                    
                    
                      2
                    
                  
                  ]
                
                +
                E
                
                  [
                  
                    
                      s
                      
                        2
                      
                    
                    [
                    n
                    ]
                  
                  ]
                
                â
                2
                E
                
                  [
                  
                    
                      â
                      
                        i
                        =
                        0
                      
                      
                        N
                      
                    
                    
                      a
                      
                        i
                      
                    
                    w
                    [
                    n
                    â
                    i
                    ]
                    s
                    [
                    n
                    ]
                  
                  ]
                
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}E\left[e^{2}[n]\right]&=E\left[(x[n]-s[n])^{2}\right]\\&=E\left[x^{2}[n]\right]+E\left[s^{2}[n]\right]-2E[x[n]s[n]]\\&=E\left[\left(\sum _{i=0}^{N}a_{i}w[n-i]\right)^{2}\right]+E\left[s^{2}[n]\right]-2E\left[\sum _{i=0}^{N}a_{i}w[n-i]s[n]\right]\end{aligned}}}
  

To find the vector 
  
    
      
        [
        
          a
          
            0
          
        
        ,
        
        â¦
        ,
        
        
          a
          
            N
          
        
        ]
      
    
    {\displaystyle [a_{0},\,\ldots ,\,a_{N}]}
  
 which minimizes the expression above, calculate its derivative with respect to each 
  
    
      
        
          a
          
            i
          
        
      
    
    {\displaystyle a_{i}}
  



  
    
      
        
          
            
              
                
                  
                    â
                    
                      â
                      
                        a
                        
                          i
                        
                      
                    
                  
                
                E
                
                  [
                  
                    
                      e
                      
                        2
                      
                    
                    [
                    n
                    ]
                  
                  ]
                
              
              
                
                =
                
                  
                    â
                    
                      â
                      
                        a
                        
                          i
                        
                      
                    
                  
                
                
                  {
                  
                    E
                    
                      [
                      
                        
                          (
                          
                            
                              â
                              
                                i
                                =
                                0
                              
                              
                                N
                              
                            
                            
                              a
                              
                                i
                              
                            
                            w
                            [
                            n
                            â
                            i
                            ]
                          
                          )
                        
                        
                          2
                        
                      
                      ]
                    
                    +
                    E
                    
                      [
                      
                        
                          s
                          
                            2
                          
                        
                        [
                        n
                        ]
                      
                      ]
                    
                    â
                    2
                    E
                    
                      [
                      
                        
                          â
                          
                            i
                            =
                            0
                          
                          
                            N
                          
                        
                        
                          a
                          
                            i
                          
                        
                        w
                        [
                        n
                        â
                        i
                        ]
                        s
                        [
                        n
                        ]
                      
                      ]
                    
                  
                  }
                
              
            
            
              
              
                
                =
                2
                E
                
                  [
                  
                    
                      (
                      
                        
                          â
                          
                            j
                            =
                            0
                          
                          
                            N
                          
                        
                        
                          a
                          
                            j
                          
                        
                        w
                        [
                        n
                        â
                        j
                        ]
                      
                      )
                    
                    w
                    [
                    n
                    â
                    i
                    ]
                  
                  ]
                
                â
                2
                E
                [
                w
                [
                n
                â
                i
                ]
                s
                [
                n
                ]
                ]
              
            
            
              
              
                
                =
                2
                
                  (
                  
                    
                      â
                      
                        j
                        =
                        0
                      
                      
                        N
                      
                    
                    E
                    [
                    w
                    [
                    n
                    â
                    j
                    ]
                    w
                    [
                    n
                    â
                    i
                    ]
                    ]
                    
                      a
                      
                        j
                      
                    
                  
                  )
                
                â
                2
                E
                [
                w
                [
                n
                â
                i
                ]
                s
                [
                n
                ]
                ]
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}{\frac {\partial }{\partial a_{i}}}E\left[e^{2}[n]\right]&={\frac {\partial }{\partial a_{i}}}\left\{E\left[\left(\sum _{i=0}^{N}a_{i}w[n-i]\right)^{2}\right]+E\left[s^{2}[n]\right]-2E\left[\sum _{i=0}^{N}a_{i}w[n-i]s[n]\right]\right\}\\&=2E\left[\left(\sum _{j=0}^{N}a_{j}w[n-j]\right)w[n-i]\right]-2E[w[n-i]s[n]]\\&=2\left(\sum _{j=0}^{N}E[w[n-j]w[n-i]]a_{j}\right)-2E[w[n-i]s[n]]\end{aligned}}}
  

Assuming that w[n] and s[n] are each stationary and jointly stationary, the sequences 
  
    
      
        
          R
          
            w
          
        
        [
        m
        ]
      
    
    {\displaystyle R_{w}[m]}
  
 and 
  
    
      
        
          R
          
            w
            s
          
        
        [
        m
        ]
      
    
    {\displaystyle R_{ws}[m]}
  
 known respectively as the autocorrelation of w[n] and the cross-correlation between w[n] and s[n] can be defined as follows:


  
    
      
        
          
            
              
                
                  R
                  
                    w
                  
                
                [
                m
                ]
              
              
                
                =
                E
                {
                w
                [
                n
                ]
                w
                [
                n
                +
                m
                ]
                }
              
            
            
              
                
                  R
                  
                    w
                    s
                  
                
                [
                m
                ]
              
              
                
                =
                E
                {
                w
                [
                n
                ]
                s
                [
                n
                +
                m
                ]
                }
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}R_{w}[m]&=E\{w[n]w[n+m]\}\\R_{ws}[m]&=E\{w[n]s[n+m]\}\end{aligned}}}
  

The derivative of the MSE may therefore be rewritten as:


  
    
      
        
          
            â
            
              â
              
                a
                
                  i
                
              
            
          
        
        E
        
          [
          
            
              e
              
                2
              
            
            [
            n
            ]
          
          ]
        
        =
        2
        
          (
          
            
              â
              
                j
                =
                0
              
              
                N
              
            
            
              R
              
                w
              
            
            [
            j
            â
            i
            ]
            
              a
              
                j
              
            
          
          )
        
        â
        2
        
          R
          
            w
            s
          
        
        [
        i
        ]
        
        i
        =
        0
        ,
        â¯
        ,
        N
        .
      
    
    {\displaystyle {\frac {\partial }{\partial a_{i}}}E\left[e^{2}[n]\right]=2\left(\sum _{j=0}^{N}R_{w}[j-i]a_{j}\right)-2R_{ws}[i]\qquad i=0,\cdots ,N.}
  

Note that for real 
  
    
      
        w
        [
        n
        ]
      
    
    {\displaystyle w[n]}
  
, the autocorrelation is symmetric:
  
    
      
        
          R
          
            w
          
        
        [
        j
        â
        i
        ]
        =
        
          R
          
            w
          
        
        [
        i
        â
        j
        ]
      
    
    {\displaystyle R_{w}[j-i]=R_{w}[i-j]}
  
Letting the derivative be equal to zero results in:


  
    
      
        
          â
          
            j
            =
            0
          
          
            N
          
        
        
          R
          
            w
          
        
        [
        j
        â
        i
        ]
        
          a
          
            j
          
        
        =
        
          R
          
            w
            s
          
        
        [
        i
        ]
        
        i
        =
        0
        ,
        â¯
        ,
        N
        .
      
    
    {\displaystyle \sum _{j=0}^{N}R_{w}[j-i]a_{j}=R_{ws}[i]\qquad i=0,\cdots ,N.}
  

which can be rewritten (using the above symmetric property) in matrix form


  
    
      
        
          
            
              
                [
                
                  
                    
                      
                        R
                        
                          w
                        
                      
                      [
                      0
                      ]
                    
                    
                      
                        R
                        
                          w
                        
                      
                      [
                      1
                      ]
                    
                    
                      â¯
                    
                    
                      
                        R
                        
                          w
                        
                      
                      [
                      N
                      ]
                    
                  
                  
                    
                      
                        R
                        
                          w
                        
                      
                      [
                      1
                      ]
                    
                    
                      
                        R
                        
                          w
                        
                      
                      [
                      0
                      ]
                    
                    
                      â¯
                    
                    
                      
                        R
                        
                          w
                        
                      
                      [
                      N
                      â
                      1
                      ]
                    
                  
                  
                    
                      â®
                    
                    
                      â®
                    
                    
                      â±
                    
                    
                      â®
                    
                  
                  
                    
                      
                        R
                        
                          w
                        
                      
                      [
                      N
                      ]
                    
                    
                      
                        R
                        
                          w
                        
                      
                      [
                      N
                      â
                      1
                      ]
                    
                    
                      â¯
                    
                    
                      
                        R
                        
                          w
                        
                      
                      [
                      0
                      ]
                    
                  
                
                ]
              
              â
            
          
          
            
              T
            
          
        
        
          
            
              
                [
                
                  
                    
                      
                        a
                        
                          0
                        
                      
                    
                  
                  
                    
                      
                        a
                        
                          1
                        
                      
                    
                  
                  
                    
                      â®
                    
                  
                  
                    
                      
                        a
                        
                          N
                        
                      
                    
                  
                
                ]
              
              â
            
          
          
            
              a
            
          
        
        =
        
          
            
              
                [
                
                  
                    
                      
                        R
                        
                          w
                          s
                        
                      
                      [
                      0
                      ]
                    
                  
                  
                    
                      
                        R
                        
                          w
                          s
                        
                      
                      [
                      1
                      ]
                    
                  
                  
                    
                      â®
                    
                  
                  
                    
                      
                        R
                        
                          w
                          s
                        
                      
                      [
                      N
                      ]
                    
                  
                
                ]
              
              â
            
          
          
            
              v
            
          
        
      
    
    {\displaystyle \underbrace {\begin{bmatrix}R_{w}[0]&R_{w}[1]&\cdots &R_{w}[N]\\R_{w}[1]&R_{w}[0]&\cdots &R_{w}[N-1]\\\vdots &\vdots &\ddots &\vdots \\R_{w}[N]&R_{w}[N-1]&\cdots &R_{w}[0]\end{bmatrix}} _{\mathbf {T} }\underbrace {\begin{bmatrix}a_{0}\\a_{1}\\\vdots \\a_{N}\end{bmatrix}} _{\mathbf {a} }=\underbrace {\begin{bmatrix}R_{ws}[0]\\R_{ws}[1]\\\vdots \\R_{ws}[N]\end{bmatrix}} _{\mathbf {v} }}
  

These equations are known as the WienerâHopf equations. The matrix T appearing in the equation is a symmetric Toeplitz matrix. Under suitable conditions on 
  
    
      
        R
      
    
    {\displaystyle R}
  
, these matrices are known to be positive definite and therefore non-singular yielding a unique solution to the determination of the Wiener filter coefficient vector, 
  
    
      
        
          a
        
        =
        
          
            T
          
          
            â
            1
          
        
        
          v
        
      
    
    {\displaystyle \mathbf {a} =\mathbf {T} ^{-1}\mathbf {v} }
  
. Furthermore, there exists an efficient algorithm to solve such WienerâHopf equations known as the Levinson-Durbin algorithm so an explicit inversion of T is not required.
In some articles, the cross correlation function is defined in the opposite way:
  
    
      
        
          R
          
            s
            w
          
        
        [
        m
        ]
        =
        E
        {
        w
        [
        n
        ]
        s
        [
        n
        +
        m
        ]
        }
      
    
    {\displaystyle R_{sw}[m]=E\{w[n]s[n+m]\}}
  
Then, the 
  
    
      
        
          v
        
      
    
    {\displaystyle \mathbf {v} }
  
 matrix will contain 
  
    
      
        
          R
          
            s
            w
          
        
        [
        0
        ]
        â¦
        
          R
          
            s
            w
          
        
        [
        N
        ]
      
    
    {\displaystyle R_{sw}[0]\ldots R_{sw}[N]}
  
; this is just a difference in notation.
Whichever notation is used, note that for real 
  
    
      
        w
        [
        n
        ]
        ,
        s
        [
        n
        ]
      
    
    {\displaystyle w[n],s[n]}
  
:
  
    
      
        
          R
          
            s
            w
          
        
        [
        k
        ]
        =
        
          R
          
            w
            s
          
        
        [
        â
        k
        ]
      
    
    {\displaystyle R_{sw}[k]=R_{ws}[-k]}
  


Relationship to the least squares filter[edit]
The realization of the causal Wiener filter looks a lot like the solution to the least squares estimate, except in the signal processing domain. The least squares solution, for input matrix 
  
    
      
        
          X
        
      
    
    {\displaystyle \mathbf {X} }
  
 and output vector 
  
    
      
        
          y
        
      
    
    {\displaystyle \mathbf {y} }
  
 is


  
    
      
        
          
            
              Î²
              ^
            
          
        
        =
        (
        
          
            X
          
          
            
              T
            
          
        
        
          X
        
        
          )
          
            â
            1
          
        
        
          
            X
          
          
            
              T
            
          
        
        
          y
        
        .
      
    
    {\displaystyle {\boldsymbol {\hat {\beta }}}=(\mathbf {X} ^{\mathbf {T} }\mathbf {X} )^{-1}\mathbf {X} ^{\mathbf {T} }{\boldsymbol {y}}.}
  

The FIR Wiener filter is related to the least mean squares filter, but minimizing the error criterion of the latter does not rely on cross-correlations or auto-correlations. Its solution converges to the Wiener filter solution.

Complex signals[edit]
For complex signals, the derivation of the complex Wiener filter is performed by minimizing 
  
    
      
        E
        
          [
          
            
              |
            
            e
            [
            n
            ]
            
              
                |
              
              
                2
              
            
          
          ]
        
      
    
    {\displaystyle E\left[|e[n]|^{2}\right]}
  
 =
  
    
      
        E
        
          [
          
            e
            [
            n
            ]
            
              e
              
                â
              
            
            [
            n
            ]
          
          ]
        
      
    
    {\displaystyle E\left[e[n]e^{*}[n]\right]}
  
.  This involves computing partial derivatives with respect to both the real and imaginary parts of 
  
    
      
        
          a
          
            i
          
        
      
    
    {\displaystyle a_{i}}
  
, and requiring them both to be zero.
The resulting Wiener-Hopf equations are:


  
    
      
        
          â
          
            j
            =
            0
          
          
            N
          
        
        
          R
          
            w
          
        
        [
        j
        â
        i
        ]
        
          a
          
            j
          
          
            â
          
        
        =
        
          R
          
            w
            s
          
        
        [
        i
        ]
        
        i
        =
        0
        ,
        â¯
        ,
        N
        .
      
    
    {\displaystyle \sum _{j=0}^{N}R_{w}[j-i]a_{j}^{*}=R_{ws}[i]\qquad i=0,\cdots ,N.}
  

which can be rewritten in matrix form:


  
    
      
        
          
            
              
                [
                
                  
                    
                      
                        R
                        
                          w
                        
                      
                      [
                      0
                      ]
                    
                    
                      
                        R
                        
                          w
                        
                        
                          â
                        
                      
                      [
                      1
                      ]
                    
                    
                      â¯
                    
                    
                      
                        R
                        
                          w
                        
                        
                          â
                        
                      
                      [
                      N
                      â
                      1
                      ]
                    
                    
                      
                        R
                        
                          w
                        
                        
                          â
                        
                      
                      [
                      N
                      ]
                    
                  
                  
                    
                      
                        R
                        
                          w
                        
                      
                      [
                      1
                      ]
                    
                    
                      
                        R
                        
                          w
                        
                      
                      [
                      0
                      ]
                    
                    
                      â¯
                    
                    
                      
                        R
                        
                          w
                        
                        
                          â
                        
                      
                      [
                      N
                      â
                      2
                      ]
                    
                    
                      
                        R
                        
                          w
                        
                        
                          â
                        
                      
                      [
                      N
                      â
                      1
                      ]
                    
                  
                  
                    
                      â®
                    
                    
                      â®
                    
                    
                      â±
                    
                    
                      â®
                    
                    
                      â®
                    
                  
                  
                    
                      
                        R
                        
                          w
                        
                      
                      [
                      N
                      â
                      1
                      ]
                    
                    
                      
                        R
                        
                          w
                        
                      
                      [
                      N
                      â
                      2
                      ]
                    
                    
                      â¯
                    
                    
                      
                        R
                        
                          w
                        
                      
                      [
                      0
                      ]
                    
                    
                      
                        R
                        
                          w
                        
                        
                          â
                        
                      
                      [
                      1
                      ]
                    
                  
                  
                    
                      
                        R
                        
                          w
                        
                      
                      [
                      N
                      ]
                    
                    
                      
                        R
                        
                          w
                        
                      
                      [
                      N
                      â
                      1
                      ]
                    
                    
                      â¯
                    
                    
                      
                        R
                        
                          w
                        
                      
                      [
                      1
                      ]
                    
                    
                      
                        R
                        
                          w
                        
                      
                      [
                      0
                      ]
                    
                  
                
                ]
              
              â
            
          
          
            
              T
            
          
        
        
          
            
              
                [
                
                  
                    
                      
                        a
                        
                          0
                        
                        
                          â
                        
                      
                    
                  
                  
                    
                      
                        a
                        
                          1
                        
                        
                          â
                        
                      
                    
                  
                  
                    
                      â®
                    
                  
                  
                    
                      
                        a
                        
                          N
                          â
                          1
                        
                        
                          â
                        
                      
                    
                  
                  
                    
                      
                        a
                        
                          N
                        
                        
                          â
                        
                      
                    
                  
                
                ]
              
              â
            
          
          
            
              
                a
                
                  â
                
              
            
          
        
        =
        
          
            
              
                [
                
                  
                    
                      
                        R
                        
                          w
                          s
                        
                      
                      [
                      0
                      ]
                    
                  
                  
                    
                      
                        R
                        
                          w
                          s
                        
                      
                      [
                      1
                      ]
                    
                  
                  
                    
                      â®
                    
                  
                  
                    
                      
                        R
                        
                          w
                          s
                        
                      
                      [
                      N
                      â
                      1
                      ]
                    
                  
                  
                    
                      
                        R
                        
                          w
                          s
                        
                      
                      [
                      N
                      ]
                    
                  
                
                ]
              
              â
            
          
          
            
              v
            
          
        
      
    
    {\displaystyle \underbrace {\begin{bmatrix}R_{w}[0]&R_{w}^{*}[1]&\cdots &R_{w}^{*}[N-1]&R_{w}^{*}[N]\\R_{w}[1]&R_{w}[0]&\cdots &R_{w}^{*}[N-2]&R_{w}^{*}[N-1]\\\vdots &\vdots &\ddots &\vdots &\vdots \\R_{w}[N-1]&R_{w}[N-2]&\cdots &R_{w}[0]&R_{w}^{*}[1]\\R_{w}[N]&R_{w}[N-1]&\cdots &R_{w}[1]&R_{w}[0]\end{bmatrix}} _{\mathbf {T} }\underbrace {\begin{bmatrix}a_{0}^{*}\\a_{1}^{*}\\\vdots \\a_{N-1}^{*}\\a_{N}^{*}\end{bmatrix}} _{\mathbf {a^{*}} }=\underbrace {\begin{bmatrix}R_{ws}[0]\\R_{ws}[1]\\\vdots \\R_{ws}[N-1]\\R_{ws}[N]\end{bmatrix}} _{\mathbf {v} }}
  

Note here that:
  
    
      
        
          
            
              
                
                  R
                  
                    w
                  
                
                [
                â
                k
                ]
              
              
                
                =
                
                  R
                  
                    w
                  
                  
                    â
                  
                
                [
                k
                ]
              
            
            
              
                
                  R
                  
                    s
                    w
                  
                
                [
                k
                ]
              
              
                
                =
                
                  R
                  
                    w
                    s
                  
                  
                    â
                  
                
                [
                â
                k
                ]
              
            
          
        
      
    
    {\displaystyle {\begin{aligned}R_{w}[-k]&=R_{w}^{*}[k]\\R_{sw}[k]&=R_{ws}^{*}[-k]\end{aligned}}}
  

The Wiener coefficient vector is then computed as:
  
    
      
        
          a
        
        =
        
          
            (
            
              
                T
              
              
                â
                1
              
            
            
              v
            
            )
          
          
            â
          
        
      
    
    {\displaystyle \mathbf {a} ={(\mathbf {T} ^{-1}\mathbf {v} )}^{*}}
  


Applications[edit]
The Wiener filter has a variety of applications in signal processing, image processing, control systems, and digital communications.  These applications generally fall into one of four main categories:

System identification
Deconvolution[3]
Noise reduction
Signal detection
.mw-parser-output .tmulti .thumbinner{display:flex;flex-direction:column}.mw-parser-output .tmulti .trow{display:flex;flex-direction:row;clear:left;flex-wrap:wrap;width:100%;box-sizing:border-box}.mw-parser-output .tmulti .tsingle{margin:1px;float:left}.mw-parser-output .tmulti .theader{clear:both;font-weight:bold;text-align:center;align-self:center;background-color:transparent;width:100%}.mw-parser-output .tmulti .thumbcaption{background-color:transparent}.mw-parser-output .tmulti .text-align-left{text-align:left}.mw-parser-output .tmulti .text-align-right{text-align:right}.mw-parser-output .tmulti .text-align-center{text-align:center}@media all and (max-width:720px){.mw-parser-output .tmulti .thumbinner{width:100%!important;box-sizing:border-box;max-width:none!important;align-items:center}.mw-parser-output .tmulti .trow{justify-content:center}.mw-parser-output .tmulti .tsingle{float:none!important;max-width:100%!important;box-sizing:border-box;text-align:center}.mw-parser-output .tmulti .tsingle .thumbcaption{text-align:left}.mw-parser-output .tmulti .trow>.thumbcaption{text-align:center}}Noisy image of an astronautThe image after a Wiener filter is applied
For example, the Wiener filter can be used in image processing to remove noise from a picture. For example, using the Mathematica function:
WienerFilter[image,2] on the first image on the right, produces the filtered image below it.

It is commonly used to denoise audio signals, especially speech, as a preprocessor before speech recognition.

History[edit]
The filter was proposed by Norbert Wiener during the 1940s and published in 1949.[4]   The discrete-time equivalent of Wiener's work was derived independently by Andrey Kolmogorov and published in 1941. Hence the theory is often called the WienerâKolmogorov filtering theory (cf. Kriging).  The Wiener filter was the first statistically designed filter to be proposed and subsequently gave rise to many others including the Kalman filter.

See also[edit]
Norbert Wiener
Eberhard Hopf
Wiener deconvolution
least mean squares filter
similarities between Wiener and LMS
linear prediction
MMSE estimator
Kalman filter
generalized Wiener filter
matched filter
Information field theory
References[edit]
.mw-parser-output .reflist{font-size:90%;margin-bottom:0.5em;list-style-type:decimal}.mw-parser-output .reflist .references{font-size:100%;margin-bottom:0;list-style-type:inherit}.mw-parser-output .reflist-columns-2{column-width:30em}.mw-parser-output .reflist-columns-3{column-width:25em}.mw-parser-output .reflist-columns{margin-top:0.3em}.mw-parser-output .reflist-columns ol{margin-top:0}.mw-parser-output .reflist-columns li{page-break-inside:avoid;break-inside:avoid-column}.mw-parser-output .reflist-upper-alpha{list-style-type:upper-alpha}.mw-parser-output .reflist-upper-roman{list-style-type:upper-roman}.mw-parser-output .reflist-lower-alpha{list-style-type:lower-alpha}.mw-parser-output .reflist-lower-greek{list-style-type:lower-greek}.mw-parser-output .reflist-lower-roman{list-style-type:lower-roman}

^ .mw-parser-output cite.citation{font-style:inherit;word-wrap:break-word}.mw-parser-output .citation q{quotes:"\"""\"""'""'"}.mw-parser-output .citation:target{background-color:rgba(0,127,255,0.133)}.mw-parser-output .id-lock-free a,.mw-parser-output .citation .cs1-lock-free a{background:linear-gradient(transparent,transparent),url("//upload.wikimedia.org/wikipedia/commons/6/65/Lock-green.svg")right 0.1em center/9px no-repeat}.mw-parser-output .id-lock-limited a,.mw-parser-output .id-lock-registration a,.mw-parser-output .citation .cs1-lock-limited a,.mw-parser-output .citation .cs1-lock-registration a{background:linear-gradient(transparent,transparent),url("//upload.wikimedia.org/wikipedia/commons/d/d6/Lock-gray-alt-2.svg")right 0.1em center/9px no-repeat}.mw-parser-output .id-lock-subscription a,.mw-parser-output .citation .cs1-lock-subscription a{background:linear-gradient(transparent,transparent),url("//upload.wikimedia.org/wikipedia/commons/a/aa/Lock-red-alt-2.svg")right 0.1em center/9px no-repeat}.mw-parser-output .cs1-ws-icon a{background:linear-gradient(transparent,transparent),url("//upload.wikimedia.org/wikipedia/commons/4/4c/Wikisource-logo.svg")right 0.1em center/12px no-repeat}.mw-parser-output .cs1-code{color:inherit;background:inherit;border:none;padding:inherit}.mw-parser-output .cs1-hidden-error{display:none;color:#d33}.mw-parser-output .cs1-visible-error{color:#d33}.mw-parser-output .cs1-maint{display:none;color:#3a3;margin-left:0.3em}.mw-parser-output .cs1-format{font-size:95%}.mw-parser-output .cs1-kern-left{padding-left:0.2em}.mw-parser-output .cs1-kern-right{padding-right:0.2em}.mw-parser-output .citation .mw-selflink{font-weight:inherit}Brown, Robert Grover; Hwang, Patrick Y.C. (1996). Introduction to Random Signals and Applied Kalman Filtering (3Â ed.). New York: John Wiley & Sons. ISBNÂ 978-0-471-12839-7.

^ Welch, Lloyd R. "WienerâHopf Theory" (PDF).[dead link]

^ [1]. "D. Boulfelfel, R.M. Rangayyan, L.J. Hahn, and R. Kloiber, 1994, "Three-dimensional restoration of single photon emission computed tomography images", IEEE Transactions on Nuclear Science, 41(5): 1746-1754, October 1994.".

^ Wiener, Norbert (1949). Extrapolation, Interpolation, and Smoothing of Stationary Time Series. New York: Wiley. ISBNÂ 978-0-262-73005-1.


Thomas Kailath, Ali H. Sayed, and Babak Hassibi, Linear Estimation, Prentice-Hall, NJ, 2000, ISBNÂ 978-0-13-022464-4.
Wiener N: The interpolation, extrapolation and smoothing of stationary time series', Report of the Services 19, Research Project DIC-6037 MIT, February 1942
Kolmogorov A.N: 'Stationary sequences in Hilbert space', (In Russian) Bull. Moscow Univ. 1941 vol.2 no.6 1-40. English translation in Kailath T. (ed.) Linear least squares estimation Dowden, Hutchinson & Ross 1977
External links[edit]
Mathematica WienerFilter function




<img src="//en.wikipedia.org/wiki/Special:CentralAutoLogin/start?type=1x1" alt="" title="" width="1" height="1" style="border: none; position: absolute;" />
Retrieved from "https://en.wikipedia.org/w/index.php?title=Wiener_filter&oldid=1065066556"
		Categories: Linear filtersImage noise reduction techniquesSignal estimationHidden categories: All articles with dead external linksArticles with dead external links from May 2020
	
